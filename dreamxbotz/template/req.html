<!--developed by Jaffer Tg_ @mineheartO --!>
<!-- Dont Remove My Credit @AV_BOTz_UPDATE -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{template_ne}} | {{file_name}}</title>
  <link rel="icon" href="https://i.ibb.co.com/wZSFb93q/6233177219853388617.jpg" type="image/x-icon" />
  <meta name="description" content="Stream high-quality videos and movies in 1080p. Experience seamless playback with multiple player options." />

  <!-- Preload and Styles -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.plyr.io/3.8.3/plyr.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    :root {
      --primary-color: #00f0ff;
      --accent-blue: #3498db;
      --bg-black: #000000;
      --glass-border: 1px solid rgba(255, 255, 255, 0.1);
      --card-radius: 16px;
      --menu-bg: #1a1f26;
      --text-color: #ffffff;
      --navbar-height: 60px;
      --footer-height: 70px;
    }

    body {
      background: var(--bg-black);
      color: var(--text-color);
      font-family: 'Outfit', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      margin: 0;
      padding-top: calc(var(--navbar-height) + 15px);
      padding-bottom: calc(var(--footer-height) + 15px);
    }

    /* Background Animation */
    #particle-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }

    /* Navbar Glass Effect */
    .navbar {
      background: rgba(0, 0, 0, 0.3) !important; 
      backdrop-filter: blur(12px); 
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      z-index: 1030;
      height: var(--navbar-height);
    }

    .navbar-brand {
      color: var(--primary-color) !important;
      font-weight: 600;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 10px;
      text-shadow: 0 0 10px rgba(0, 240, 255, 0.3);
    }

    .header-logo { height: 28px; width: auto; }
    .custom-logo-icon { height: 18px; width: auto; object-fit: contain; }

    /* Dropdown Menu */
    .dropdown-menu-custom {
      background-color: rgba(26, 31, 38, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      min-width: 220px;
      position: absolute;
      right: 10px;
      top: 55px;
      display: none;
      z-index: 1050;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
    .dropdown-menu-custom.show { display: block; }
    .menu-item {
      display: flex;
      align-items: center;
      padding: 15px 20px;
      color: #e0e0e0;
      text-decoration: none;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      transition: 0.3s;
    }
    .menu-item:hover { background: rgba(255, 255, 255, 0.05); color: var(--primary-color); }

    /* Video Player Wrapper */
    .player-wrapper {
      background: #000;
      border-radius: var(--card-radius);
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      border: var(--glass-border);
      position: relative;
      width: 100%;
    }

    /* PLYR CUSTOMIZATION */
    :root { 
        --plyr-color-main: #00f0ff; 
        --plyr-video-background: #000;
        --plyr-menu-background: rgba(26, 31, 38, 0.95);
        --plyr-menu-color: #fff;
    }
    
    .plyr--video .plyr__controls {
      display: flex;
      flex-wrap: wrap; 
      padding: 10px 15px;
      background: linear-gradient(transparent, rgba(0, 0, 0, 0.9)) !important;
      gap: 5px;
    }
    
    .plyr--video .plyr__controls .plyr__progress__container {
      flex: 0 0 100%; 
      order: 1;      
      margin-bottom: 8px; 
    }
    
    .plyr--video .plyr__controls .plyr__controls__item { order: 2; }
    .plyr__controls__item[data-plyr="settings"] { margin-left: auto; }

    /* Loading Spinner */
    #loading-overlay {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
      transition: opacity 0.5s;
    }
    .spinner-border { color: var(--primary-color); width: 3rem; height: 3rem; }

    /* WATERMARK ANIMATION */
    .player-watermark {
      position: absolute;
      top: 15px;
      right: 15px;
      z-index: 20; 
      pointer-events: none;
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--primary-color);
      opacity: 0;
      font-family: 'Courier New', Courier, monospace; 
      font-size: 0.7rem; 
      font-weight: bold;
      text-transform: uppercase;
      animation: popupEntrance 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
      animation-delay: 0.5s; 
    }
    .player-watermark span {
        display: inline-block;
        overflow: hidden;
        white-space: nowrap;
        border-right: 2px solid var(--primary-color);
        width: 0; 
        animation: typing 2.5s steps(30, end) forwards, blink-caret 0.75s step-end infinite;
        animation-delay: 1.1s; 
    }
    @keyframes popupEntrance { 0% { transform: scale(0); opacity: 0; } 100% { transform: scale(1); opacity: 0.5; } }
    @keyframes typing { from { width: 0 } to { width: 100% } }
    @keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: var(--primary-color) } }

    /* Cards & Buttons */
    .glass-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 15px;
      margin-top: 15px;
    }
    .action-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
    .btn-outline-custom {
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid #ffffff;
      border-radius: 15px;
      color: #ffffff;
      padding: 12px 5px;
      display: flex; align-items: center; justify-content: center; gap: 8px;
      text-decoration: none; font-size: 0.85rem; transition: 0.3s;
      cursor: pointer;
    }
    .btn-outline-custom:hover { background: rgba(0, 240, 255, 0.1); border-color: var(--primary-color); color: var(--primary-color); }
    .btn-full-width { grid-column: span 3; padding: 15px; }

    .external-players-container {
      grid-column: span 3; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
      max-height: 0; overflow: hidden; transition: 0.5s ease-in-out; opacity: 0;
    }
    .external-players-container.show { max-height: 120px; opacity: 1; margin-top: 10px; }
    
    footer { 
      position: fixed;
      bottom: 0; left: 0; width: 100%;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(12px); 
      padding: 15px; 
      text-align: center; 
      border-top: 1px solid rgba(255, 255, 255, 0.05); 
      z-index: 1030;
      height: var(--footer-height);
      display: flex; align-items: center; justify-content: center;
    }

    @media (max-width: 768px) {
      .plyr__volume { display: none !important; }
      .plyr--video .plyr__controls { padding: 5px 8px !important; }
      .btn-outline-custom { font-size: 0.75rem; }
    }
  </style>
</head>

<body>
  <canvas id="particle-canvas"></canvas>

  <nav class="navbar navbar-dark fixed-top">
    <div class="container d-flex justify-content-between align-items-center">
      <a class="navbar-brand m-0" href="#">
        <img src="https://i.ibb.co.com/wZSFb93q/6233177219853388617.jpg" alt="Logo" class="header-logo">
        {{template_ne}}
      </a>
      <button class="navbar-toggler" type="button" onclick="toggleMenu(event)">
        <i class="fa-solid fa-bars"></i>
      </button>
      <div id="customMenu" class="dropdown-menu-custom">
        <a href="https://t.me/+SUy4f5u0jB5lYzk9" target="_blank" class="menu-item"><i class="fa-solid fa-arrows-rotate me-2"></i> Update'S</a>
        <a href="https://t.me/mineheartO" target="_blank" class="menu-item"><i class="fa-solid fa-envelope me-2"></i> Contact</a>
        <a href="https://t.me/+v3ssj9qdavVhNWQ9" target="_blank" class="menu-item"><i class="fa-solid fa-file-lines me-2"></i> Report</a>
        <a href="https://t.me/affanoiupload_bot" target="_blank" class="menu-item"><i class="fa-brands fa-telegram me-2"></i> Bot Link</a>
      </div>
    </div>
  </nav>

  <main class="container">
    <div class="player-wrapper shadow-lg">
      <div id="loading-overlay">
        <div class="spinner-border" role="status"></div>
      </div>
      
      <div class="player-watermark" id="videoWatermark">
        <img src="https://i.ibb.co/Nn6x9Dhd/file-000000004c3071fa8a1196c3bdcf46d0.png" alt="Logo" class="custom-logo-icon">
        <span>{{template_ne}}</span>
      </div>

      <!-- Video Element without src, handled by JS -->
      <video id="myVideo" crossorigin playsinline controls></video>
    </div>

    <div class="glass-card">
      <div class="fw-bold mb-3"><i class="fa-solid fa-folder-open me-2 text-info"></i> File Information</div>
      <div class="small mb-1"><span class="text-info">Name:</span> {{file_name}}</div>
      <div class="small mb-1"><span class="text-info">Size:</span> {{file_size}}</div>
      <div class="small"><span class="text-info">Type:</span> <span id="streamType">Detecting...</span></div>
    </div>

    <div class="action-grid mt-3">
      <a onclick="copyLink()" class="btn-outline-custom"><i class="fa-regular fa-copy"></i> Copy</a>
      <a onclick="shareButton()" class="btn-outline-custom"><i class="fa-solid fa-share-nodes"></i> Share</a>
      <a onclick="triggerDownload()" class="btn-outline-custom"><i class="fa-solid fa-download"></i> Download</a>

      <a href="https://t.me/affanoiupload_bot" class="btn-outline-custom btn-full-width"><i class="fa-brands fa-telegram me-2"></i> Create Like This Link</a>

      <div class="btn-outline-custom btn-full-width" onclick="toggleExternalPlayers()">
        <i class="fa-solid fa-circle-play"></i> Play in External Player <i class="fa-solid fa-chevron-down ms-2" id="chevron"></i>
      </div>

      <div class="external-players-container" id="playerList">
        <a onclick="vlc_player()" class="btn-outline-custom player-btn"><i class="fa-solid fa-play" style="color: #ff8800;"></i> VLC</a>
        <a onclick="mx_player()" class="btn-outline-custom player-btn"><i class="fa-solid fa-video" style="color: #3498db;"></i> MX Player</a>
        <a onclick="playit_player()" class="btn-outline-custom player-btn"><i class="fa-solid fa-clapperboard" style="color: #2ecc71;"></i> PlayIt</a>
      </div>
    </div>

    <div class="glass-card mb-4">
        <div class="fw-bold text-warning mb-2"><i class="fa-solid fa-triangle-exclamation me-2"></i> Disclaimer</div>
        <p class="small text-secondary mb-0">{{disclaimer}}</p>
    </div>
  </main>

  <footer>
    <a href="https://www.instagram.com/nova_jfrrr?igsh=MTdwM2YwNTVwNzV4cA==" target="_blank" class="text-decoration-none" style="color: var(--primary-color)">
      <img src="https://i.ibb.co.com/wZSFb93q/6233177219853388617.jpg" alt="Logo" class="custom-logo-icon me-2">
      <span>Dev by Mr.Jaffer</span>
    </a>
  </footer>

  <!-- Scripts: HLS.js for m3u8 and Plyr for UI -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script src="https://cdn.plyr.io/3.8.3/plyr.js"></script>

  <script>
    const fileUrl = "{{file_url}}";
    const fileName = "{{file_name}}";
    const video = document.getElementById('myVideo');
    const loadingOverlay = document.getElementById('loading-overlay');
    
    // 1. Initialize Plyr
    const player = new Plyr(video, {
      controls: ['progress', 'play-large', 'play', 'rewind', 'fast-forward', 'current-time', 'duration', 'mute', 'volume', 'settings', 'pip', 'airplay', 'fullscreen'],
      seekTime: 10,
      settings: ['quality', 'speed', 'caption'],
      speed: { selected: 1, options: [0.5, 0.75, 1, 1.25, 1.5, 2] },
      quality: { default: 576, options: [4320, 2880, 2160, 1440, 1080, 720, 576, 480, 360, 240] }
    });

    // 2. Handle HLS (m3u8) or MP4
    if (fileUrl.includes('.m3u8')) {
      document.getElementById('streamType').innerText = "HLS Stream (.m3u8)";
      if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(fileUrl);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, function (event, data) {
          // Add quality options from manifest
          const availableQualities = hls.levels.map((l) => l.height);
          player.config.quality = {
            default: availableQualities[0],
            options: availableQualities,
            forced: true,
            onChange: (e) => updateQuality(e),
          };
          loadingOverlay.style.opacity = '0';
          setTimeout(() => loadingOverlay.style.display = 'none', 500);
        });
        
        window.hls = hls; // Export for quality change function
      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        // Fallback for Safari
        video.src = fileUrl;
        loadingOverlay.style.display = 'none';
      }
    } else {
      // Direct MP4 Source
      document.getElementById('streamType').innerText = "Direct MP4 Video";
      video.src = fileUrl;
      video.onloadedmetadata = () => {
        loadingOverlay.style.opacity = '0';
        setTimeout(() => loadingOverlay.style.display = 'none', 500);
      };
    }

    function updateQuality(newQuality) {
      if (window.hls) {
        window.hls.levels.forEach((level, levelIndex) => {
          if (level.height === newQuality) {
            window.hls.currentLevel = levelIndex;
          }
        });
      }
    }

    // --- Original UI Functions ---
    function toggleMenu(e) { e.stopPropagation(); document.getElementById('customMenu').classList.toggle('show'); }
    window.onclick = () => document.getElementById('customMenu').classList.remove('show');

    function toggleExternalPlayers() {
      const list = document.getElementById('playerList');
      const chev = document.getElementById('chevron');
      list.classList.toggle('show');
      chev.style.transform = list.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
    }

    player.on('ready', () => {
        const wm = document.getElementById('videoWatermark');
        const container = document.querySelector('.plyr');
        if(wm && container) container.appendChild(wm);
    });

    player.on('enterfullscreen', () => {
        if (screen.orientation && screen.orientation.lock) {
            screen.orientation.lock('landscape').catch(() => {});
        }
    });

    function triggerDownload() {
        const link = document.createElement('a');
        link.href = fileUrl;
        link.setAttribute('download', fileName);
        link.target = '_blank';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
    
    function shareButton() {
        if (navigator.share) {
            navigator.share({ title: fileName, url: window.location.href }).catch(console.error);
        } else {
            copyLink();
        }
    }

    function copyLink() { 
        navigator.clipboard.writeText(window.location.href); 
        alert("Link Copied!"); 
    }

    // --- Intent Links for External Players ---
    function mx_player() { window.location.href = `intent://${fileUrl.replace(/^https?:\/\//, '')}#Intent;package=com.mxtech.videoplayer.ad;type=video/*;scheme=https;end`; }
    function vlc_player() { window.location.href = `intent://${fileUrl.replace(/^https?:\/\//, '')}#Intent;package=org.videolan.vlc;type=video/*;scheme=https;end`; }
    function playit_player() { window.location.href = `intent://${fileUrl.replace(/^https?:\/\//, '')}#Intent;package=com.playit.videoplayer;type=video/*;scheme=https;end`; }

    // --- Enhanced Particle Engine ---
    const canvas = document.getElementById('particle-canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    let mouse = { x: null, y: null, radius: 150 };

    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener('resize', resize);
    window.addEventListener('mousemove', (e) => { mouse.x = e.x; mouse.y = e.y; });
    resize();

    class Particle {
      constructor() { this.reset(); }
      reset() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.vx = (Math.random() - 0.5) * 0.8;
        this.vy = (Math.random() - 0.5) * 0.8;
        this.size = Math.random() * 2 + 1;
      }
      update() {
        this.x += this.vx; this.y += this.vy;
        if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
        if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
        if (mouse.x != null) {
          let dx = mouse.x - this.x; let dy = mouse.y - this.y;
          let dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < mouse.radius) { this.x += dx * 0.01; this.y += dy * 0.01; }
        }
      }
      draw() {
        ctx.fillStyle = 'rgba(0, 240, 255, 0.4)';
        ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fill();
      }
    }

    for (let i = 0; i < 90; i++) particles.push(new Particle());
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles.forEach((p, i) => {
        p.update(); p.draw();
        for (let j = i + 1; j < particles.length; j++) {
          let dx = p.x - particles[j].x; let dy = p.y - particles[j].y;
          let d = Math.sqrt(dx * dx + dy * dy);
          if (d < 150) {
            ctx.strokeStyle = `rgba(0, 240, 255, ${1 - d/150})`;
            ctx.lineWidth = 0.5; ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(particles[j].x, particles[j].y); ctx.stroke();
          }
        }
      });
      requestAnimationFrame(draw);
    }
    draw();
  </script>
</body>
                                                                                  </html>


